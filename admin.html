<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>ORACLE | MONITOR PANEL v30.0</title>
    <style>
        :root { --neon: #00f2ff; --bg: #020202; --panel: #0d0d0d; --text: #eee; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Courier New', monospace; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 15px; }
        .card { background: var(--panel); border: 1px solid #333; padding: 15px; border-radius: 4px; }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 5px; border-bottom: 1px solid #1a1a1a; padding: 5px 0; }
        .val { color: var(--neon); font-weight: bold; }
        .hype-box { color: #ff4500; font-size: 1.2rem; text-align: right; }
        h2 { color: white; margin: 0 0 10px 0; border-bottom: 2px solid var(--neon); }
    </style>
</head>
<body>
    <h1 style="color:var(--neon)">ORACLE // LIVE MONITOR</h1>
    <div id="display" class="grid"></div>

    <script>
        const SB_URL = "https://zrbqhhnxshrayctqmncy.supabase.co";
        const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpyYnFoaG54c2hyYXljdHFtbmN5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2ODE2MjcsImV4cCI6MjA4NzI1NzYyN30.7JA6rGog3TphPqdb3tbHz4D03haXSFWZOXwi2yK_uek";

        async function refreshData() {
            try {
                // 1. Načteme Hype
                const hRes = await fetch(`${SB_URL}/rest/v1/oracle_hype?select=*`, { headers: {'apikey': SB_KEY, 'Authorization': `Bearer ${SB_KEY}`} });
                const hypes = await hRes.json();
                
                // 2. Načteme impulsy (všechny)
                const sRes = await fetch(`${SB_URL}/rest/v1/oracle_signals?select=*&order=created_at.desc`, { headers: {'apikey': SB_KEY, 'Authorization': `Bearer ${SB_KEY}`} });
                const signals = await sRes.json();

                const assets = ["BTC", "PI", "ETH", "M"];
                let html = "";

                assets.forEach(sym => {
                    const assetHype = hypes.find(h => h.symbol === sym)?.score || "??";
                    const assetSignals = signals.filter(s => s.symbol === sym).slice(0, 6); // Vezmeme posledních 6 (pro různé TF)

                    html += `<div class="card">
                        <div style="display:flex; justify-content:space-between">
                            <h2>${sym}</h2>
                            <div class="hype-box">HYPE: ${assetHype}%</div>
                        </div>
                        <div style="font-size: 0.8rem; margin-top: 10px;">`;
                    
                    assetSignals.forEach(s => {
                        html += `
                        <div class="info-row">
                            <span>[${s.timeframe}] ${s.verdict}</span>
                            <span class="val">${s.price.toFixed(4)} $</span>
                        </div>
                        <div style="font-size:0.7rem; color:#aaa; margin-bottom:10px;">${s.analysis}</div>`;
                    });

                    html += `</div></div>`;
                });

                document.getElementById('display').innerHTML = html;
            } catch (e) { console.error(e); }
        }

        setInterval(refreshData, 10000);
        refreshData();
    </script>
</body>
</html>